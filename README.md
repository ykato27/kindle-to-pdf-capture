# Kindle自動スクリーンショット＆PDF化システム

Windows 上の Kindle for PC で開いている電子書籍を、指定ページ数ぶん自動でスクリーンショットし、1 冊分の PDF にまとめる Python ツールです。pyautogui の緊急停止機能を有効にしたまま動作するため、マウスカーソルを画面左上に移動させればいつでも処理を中断できます。

## セットアップ

1. 依存ライブラリをインストールします。
   ```bash
   uv sync
   ```
2. Kindle for PC でキャプチャしたい書籍を開き、最初のページを表示しておきます。

## 使い方

uv の仮想環境内で以下を実行します。

```bash
uv run python -m kindle_capture
```

対話形式で以下を入力します。

- 書籍名（フォルダ名や PDF ファイル名の基礎になります）
- キャプチャするページ数
- ページ送りキー（R: 右矢印、L: 左矢印、P: PageDown）
- スクリーンショット後の待機秒数（省略可）
- ページ送り後の待機秒数（省略可）

カウントダウン終了後、指定したページ数ぶんのスクリーンショットを撮影し、`~/kindle_capture/<書籍名>/` 配下に画像と PDF を保存します。

### 留意点

- 入力された書籍名は Windows で使用できない文字（`\\/:*?"<>|`）を自動で置換した上で、保存先フォルダや PDF 名に利用します。
- 待機秒数の入力が 0 未満または数値以外の場合は、それぞれ既定値（スクリーンショット後 0.5 秒 / ページ送り後 1.0 秒）に丸められます。
- キャプチャ中に危険を感じたら、マウスカーソルを画面左上に移動させることで pyautogui のフェイルセーフが発動し、即座に停止できます。
- Kindle 画面のページ送りは、キーを押し込んで離す処理で確実に送るようにしており、同じ画面が 3 回続いた場合は最後の 2 枚を削除して自動終了します。
