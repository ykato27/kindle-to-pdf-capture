# Kindle自動スクリーンショット＆PDF化システム

Windows版Kindleアプリから1ページずつ自動でスクリーンショットを取得し、1冊の本を1つのPDFファイルにまとめるシステムです。

## 機能

- **自動ページキャプチャ**: Kindleアプリのページを自動でキャプチャ
- **自動ページめくり**: 右矢印キーでページを自動でめくり
- **完了判定**: 同じページが3回連続で表示されたら自動終了
- **PDF生成**: 取得した全ページを1つのPDFファイルに結合
- **高品質保存**: 最高品質（quality=95）でPDFを保存

## システム要件

- Python 3.7以上
- Windows 10/11
- Kindleアプリ（Windows版）

## インストール

1. 依存ライブラリをインストール：
```bash
pip install -r requirements.txt
```

## 使い方

### 基本手順

1. Kindleアプリで読みたい本を開きます
2. 本の最初のページを表示します
3. スクリプトを実行します：
```bash
python kindle_to_pdf.py
```

4. プロンプトで以下の情報を入力します：
   - **出力先フォルダ**: PDF出力フォルダのパス（デフォルト: カレントディレクトリ）
   - **本のタイトル**: PDFのファイル名として使用します

5. スクリプトが自動でページをキャプチャして処理を開始します

6. 完了メッセージが表示されたら、指定のフォルダにPDFが生成されています

### 処理の中断

Ctrl+C を押すことで処理を中断できます。

## 処理フロー

```
1. Kindleアプリのウィンドウを検索
2. ウィンドウを前面に表示
3. 初回スクリーンショット取得
4. 以下をループ
   - 右矢印キーを送信してページめくり
   - 1秒待機
   - スクリーンショット取得
   - 前回の画像と比較
   - 同一画像が3回連続なら終了、異なれば継続
5. 取得した全画像を1つのPDFに結合
6. 一時ファイルを削除
7. 完了メッセージ表示
```

## トラブルシューティング

### Kindleアプリが見つからない

- Kindleアプリが起動していることを確認してください
- Kindleアプリのウィンドウタイトルが「kindle」を含んでいることを確認してください

### ページがうまくめくれない

- Kindleアプリがアクティブになっていることを確認してください
- キーボード入力が正しく機能していることを確認してください

### PDFが作成されない

- 出力先フォルダが書き込み可能なことを確認してください
- ディスク容量に十分な空きがあることを確認してください

## 技術仕様

### 使用ライブラリ

- **pyautogui**: ウィンドウ検出、キーボード操作、スクリーンショット取得
- **pygetwindow**: ウィンドウ操作
- **Pillow**: 画像処理、PDF変換
- **imagehash**: 画像のハッシュ値計算（同一ページ検出用）

### 重要なパラメータ

- **ページめくり待機時間**: 1秒（ページ表示待機）
- **同一ページ判定**: 3回連続で同じハッシュ値（最高の確実性）
- **PDF品質**: 95（高品質）

## ライセンス

MIT License - 詳細は LICENSE ファイルを参照してください